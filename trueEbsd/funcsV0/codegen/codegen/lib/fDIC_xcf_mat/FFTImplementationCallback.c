/*
 * Non-Degree Granting Education License -- for use at non-degree
 * granting, nonprofit, education, and research organizations only. Not
 * for commercial or industrial use.
 *
 * FFTImplementationCallback.c
 *
 * Code generation for function 'FFTImplementationCallback'
 *
 */

/* Include files */
#include "FFTImplementationCallback.h"
#include "fDIC_xcf_mat_emxutil.h"
#include "fDIC_xcf_mat_types.h"
#include "rt_nonfinite.h"
#include "omp.h"
#include <math.h>

/* Function Declarations */
static void c_FFTImplementationCallback_doH(const double x[16384], int xoffInit,
                                            creal_T y[128]);

static void f_FFTImplementationCallback_r2b(const emxArray_creal_T *x,
                                            int unsigned_nRows,
                                            const emxArray_real_T *costab,
                                            const emxArray_real_T *sintab,
                                            emxArray_creal_T *y);

/* Function Definitions */
static void c_FFTImplementationCallback_doH(const double x[16384], int xoffInit,
                                            creal_T y[128])
{
  static const creal_T reconVar1[64] = {{
                                            1.0, /* re */
                                            -1.0 /* im */
                                        },
                                        {
                                            0.950932325672582,   /* re */
                                            -0.99879545620517241 /* im */
                                        },
                                        {
                                            0.90198285967043934, /* re */
                                            -0.99518472667219693 /* im */
                                        },
                                        {
                                            0.85326952554463831, /* re */
                                            -0.989176509964781   /* im */
                                        },
                                        {
                                            0.80490967798387181, /* re */
                                            -0.98078528040323043 /* im */
                                        },
                                        {
                                            0.75701982009673618, /* re */
                                            -0.970031253194544   /* im */
                                        },
                                        {
                                            0.70971532274553772, /* re */
                                            -0.95694033573220882 /* im */
                                        },
                                        {
                                            0.66311014660778,    /* re */
                                            -0.94154406518302081 /* im */
                                        },
                                        {
                                            0.61731656763491016, /* re */
                                            -0.92387953251128674 /* im */
                                        },
                                        {
                                            0.57244490656971792, /* re */
                                            -0.90398929312344334 /* im */
                                        },
                                        {
                                            0.5286032631740023, /* re */
                                            -0.881921264348355  /* im */
                                        },
                                        {
                                            0.48589725580677834, /* re */
                                            -0.85772861000027212 /* im */
                                        },
                                        {
                                            0.44442976698039782, /* re */
                                            -0.83146961230254524 /* im */
                                        },
                                        {
                                            0.40430069550756664, /* re */
                                            -0.80320753148064494 /* im */
                                        },
                                        {
                                            0.36560671583635451, /* re */
                                            -0.773010453362737   /* im */
                                        },
                                        {
                                            0.32844104515298167, /* re */
                                            -0.74095112535495922 /* im */
                                        },
                                        {
                                            0.29289321881345243, /* re */
                                            -0.70710678118654757 /* im */
                                        },
                                        {
                                            0.25904887464504078, /* re */
                                            -0.67155895484701833 /* im */
                                        },
                                        {
                                            0.226989546637263,   /* re */
                                            -0.63439328416364549 /* im */
                                        },
                                        {
                                            0.19679246851935506, /* re */
                                            -0.59569930449243336 /* im */
                                        },
                                        {
                                            0.16853038769745476, /* re */
                                            -0.55557023301960218 /* im */
                                        },
                                        {
                                            0.14227138999972788, /* re */
                                            -0.51410274419322166 /* im */
                                        },
                                        {
                                            0.11807873565164495, /* re */
                                            -0.47139673682599764 /* im */
                                        },
                                        {
                                            0.096010706876556662, /* re */
                                            -0.42755509343028208  /* im */
                                        },
                                        {
                                            0.076120467488713262, /* re */
                                            -0.38268343236508978  /* im */
                                        },
                                        {
                                            0.058455934816979194, /* re */
                                            -0.33688985339222005  /* im */
                                        },
                                        {
                                            0.043059664267791176, /* re */
                                            -0.29028467725446233  /* im */
                                        },
                                        {
                                            0.029968746805456026, /* re */
                                            -0.24298017990326387  /* im */
                                        },
                                        {
                                            0.019214719596769569, /* re */
                                            -0.19509032201612825  /* im */
                                        },
                                        {
                                            0.010823490035218986, /* re */
                                            -0.14673047445536175  /* im */
                                        },
                                        {
                                            0.0048152733278030713, /* re */
                                            -0.0980171403295606    /* im */
                                        },
                                        {
                                            0.001204543794827595, /* re */
                                            -0.049067674327418015 /* im */
                                        },
                                        {
                                            0.0, /* re */
                                            -0.0 /* im */
                                        },
                                        {
                                            0.001204543794827595, /* re */
                                            0.049067674327418015  /* im */
                                        },
                                        {
                                            0.0048152733278030713, /* re */
                                            0.0980171403295606     /* im */
                                        },
                                        {
                                            0.010823490035218986, /* re */
                                            0.14673047445536175   /* im */
                                        },
                                        {
                                            0.019214719596769569, /* re */
                                            0.19509032201612825   /* im */
                                        },
                                        {
                                            0.029968746805456026, /* re */
                                            0.24298017990326387   /* im */
                                        },
                                        {
                                            0.043059664267791176, /* re */
                                            0.29028467725446233   /* im */
                                        },
                                        {
                                            0.058455934816979194, /* re */
                                            0.33688985339222005   /* im */
                                        },
                                        {
                                            0.076120467488713262, /* re */
                                            0.38268343236508978   /* im */
                                        },
                                        {
                                            0.096010706876556662, /* re */
                                            0.42755509343028208   /* im */
                                        },
                                        {
                                            0.11807873565164495, /* re */
                                            0.47139673682599764  /* im */
                                        },
                                        {
                                            0.14227138999972788, /* re */
                                            0.51410274419322166  /* im */
                                        },
                                        {
                                            0.16853038769745476, /* re */
                                            0.55557023301960218  /* im */
                                        },
                                        {
                                            0.19679246851935506, /* re */
                                            0.59569930449243336  /* im */
                                        },
                                        {
                                            0.226989546637263,  /* re */
                                            0.63439328416364549 /* im */
                                        },
                                        {
                                            0.25904887464504078, /* re */
                                            0.67155895484701833  /* im */
                                        },
                                        {
                                            0.29289321881345243, /* re */
                                            0.70710678118654757  /* im */
                                        },
                                        {
                                            0.32844104515298167, /* re */
                                            0.74095112535495922  /* im */
                                        },
                                        {
                                            0.36560671583635451, /* re */
                                            0.773010453362737    /* im */
                                        },
                                        {
                                            0.40430069550756664, /* re */
                                            0.80320753148064494  /* im */
                                        },
                                        {
                                            0.44442976698039782, /* re */
                                            0.83146961230254524  /* im */
                                        },
                                        {
                                            0.48589725580677834, /* re */
                                            0.85772861000027212  /* im */
                                        },
                                        {
                                            0.5286032631740023, /* re */
                                            0.881921264348355   /* im */
                                        },
                                        {
                                            0.57244490656971792, /* re */
                                            0.90398929312344334  /* im */
                                        },
                                        {
                                            0.61731656763491016, /* re */
                                            0.92387953251128674  /* im */
                                        },
                                        {
                                            0.66311014660778,   /* re */
                                            0.94154406518302081 /* im */
                                        },
                                        {
                                            0.70971532274553772, /* re */
                                            0.95694033573220882  /* im */
                                        },
                                        {
                                            0.75701982009673618, /* re */
                                            0.970031253194544    /* im */
                                        },
                                        {
                                            0.80490967798387181, /* re */
                                            0.98078528040323043  /* im */
                                        },
                                        {
                                            0.85326952554463831, /* re */
                                            0.989176509964781    /* im */
                                        },
                                        {
                                            0.90198285967043934, /* re */
                                            0.99518472667219693  /* im */
                                        },
                                        {
                                            0.950932325672582,  /* re */
                                            0.99879545620517241 /* im */
                                        }};
  static const creal_T reconVar2[64] = {{
                                            1.0, /* re */
                                            1.0  /* im */
                                        },
                                        {
                                            1.0490676743274181, /* re */
                                            0.99879545620517241 /* im */
                                        },
                                        {
                                            1.0980171403295607, /* re */
                                            0.99518472667219693 /* im */
                                        },
                                        {
                                            1.1467304744553617, /* re */
                                            0.989176509964781   /* im */
                                        },
                                        {
                                            1.1950903220161282, /* re */
                                            0.98078528040323043 /* im */
                                        },
                                        {
                                            1.2429801799032638, /* re */
                                            0.970031253194544   /* im */
                                        },
                                        {
                                            1.2902846772544623, /* re */
                                            0.95694033573220882 /* im */
                                        },
                                        {
                                            1.33688985339222,   /* re */
                                            0.94154406518302081 /* im */
                                        },
                                        {
                                            1.3826834323650898, /* re */
                                            0.92387953251128674 /* im */
                                        },
                                        {
                                            1.4275550934302821, /* re */
                                            0.90398929312344334 /* im */
                                        },
                                        {
                                            1.4713967368259977, /* re */
                                            0.881921264348355   /* im */
                                        },
                                        {
                                            1.5141027441932216, /* re */
                                            0.85772861000027212 /* im */
                                        },
                                        {
                                            1.5555702330196022, /* re */
                                            0.83146961230254524 /* im */
                                        },
                                        {
                                            1.5956993044924332, /* re */
                                            0.80320753148064494 /* im */
                                        },
                                        {
                                            1.6343932841636455, /* re */
                                            0.773010453362737   /* im */
                                        },
                                        {
                                            1.6715589548470184, /* re */
                                            0.74095112535495922 /* im */
                                        },
                                        {
                                            1.7071067811865475, /* re */
                                            0.70710678118654757 /* im */
                                        },
                                        {
                                            1.7409511253549592, /* re */
                                            0.67155895484701833 /* im */
                                        },
                                        {
                                            1.7730104533627369, /* re */
                                            0.63439328416364549 /* im */
                                        },
                                        {
                                            1.8032075314806448, /* re */
                                            0.59569930449243336 /* im */
                                        },
                                        {
                                            1.8314696123025453, /* re */
                                            0.55557023301960218 /* im */
                                        },
                                        {
                                            1.8577286100002721, /* re */
                                            0.51410274419322166 /* im */
                                        },
                                        {
                                            1.8819212643483549, /* re */
                                            0.47139673682599764 /* im */
                                        },
                                        {
                                            1.9039892931234434, /* re */
                                            0.42755509343028208 /* im */
                                        },
                                        {
                                            1.9238795325112867, /* re */
                                            0.38268343236508978 /* im */
                                        },
                                        {
                                            1.9415440651830207, /* re */
                                            0.33688985339222005 /* im */
                                        },
                                        {
                                            1.9569403357322088, /* re */
                                            0.29028467725446233 /* im */
                                        },
                                        {
                                            1.9700312531945441, /* re */
                                            0.24298017990326387 /* im */
                                        },
                                        {
                                            1.9807852804032304, /* re */
                                            0.19509032201612825 /* im */
                                        },
                                        {
                                            1.9891765099647811, /* re */
                                            0.14673047445536175 /* im */
                                        },
                                        {
                                            1.9951847266721969, /* re */
                                            0.0980171403295606  /* im */
                                        },
                                        {
                                            1.9987954562051724,  /* re */
                                            0.049067674327418015 /* im */
                                        },
                                        {
                                            2.0, /* re */
                                            0.0  /* im */
                                        },
                                        {
                                            1.9987954562051724,   /* re */
                                            -0.049067674327418015 /* im */
                                        },
                                        {
                                            1.9951847266721969, /* re */
                                            -0.0980171403295606 /* im */
                                        },
                                        {
                                            1.9891765099647811,  /* re */
                                            -0.14673047445536175 /* im */
                                        },
                                        {
                                            1.9807852804032304,  /* re */
                                            -0.19509032201612825 /* im */
                                        },
                                        {
                                            1.9700312531945441,  /* re */
                                            -0.24298017990326387 /* im */
                                        },
                                        {
                                            1.9569403357322088,  /* re */
                                            -0.29028467725446233 /* im */
                                        },
                                        {
                                            1.9415440651830207,  /* re */
                                            -0.33688985339222005 /* im */
                                        },
                                        {
                                            1.9238795325112867,  /* re */
                                            -0.38268343236508978 /* im */
                                        },
                                        {
                                            1.9039892931234434,  /* re */
                                            -0.42755509343028208 /* im */
                                        },
                                        {
                                            1.8819212643483549,  /* re */
                                            -0.47139673682599764 /* im */
                                        },
                                        {
                                            1.8577286100002721,  /* re */
                                            -0.51410274419322166 /* im */
                                        },
                                        {
                                            1.8314696123025453,  /* re */
                                            -0.55557023301960218 /* im */
                                        },
                                        {
                                            1.8032075314806448,  /* re */
                                            -0.59569930449243336 /* im */
                                        },
                                        {
                                            1.7730104533627369,  /* re */
                                            -0.63439328416364549 /* im */
                                        },
                                        {
                                            1.7409511253549592,  /* re */
                                            -0.67155895484701833 /* im */
                                        },
                                        {
                                            1.7071067811865475,  /* re */
                                            -0.70710678118654757 /* im */
                                        },
                                        {
                                            1.6715589548470184,  /* re */
                                            -0.74095112535495922 /* im */
                                        },
                                        {
                                            1.6343932841636455, /* re */
                                            -0.773010453362737  /* im */
                                        },
                                        {
                                            1.5956993044924332,  /* re */
                                            -0.80320753148064494 /* im */
                                        },
                                        {
                                            1.5555702330196022,  /* re */
                                            -0.83146961230254524 /* im */
                                        },
                                        {
                                            1.5141027441932216,  /* re */
                                            -0.85772861000027212 /* im */
                                        },
                                        {
                                            1.4713967368259977, /* re */
                                            -0.881921264348355  /* im */
                                        },
                                        {
                                            1.4275550934302821,  /* re */
                                            -0.90398929312344334 /* im */
                                        },
                                        {
                                            1.3826834323650898,  /* re */
                                            -0.92387953251128674 /* im */
                                        },
                                        {
                                            1.33688985339222,    /* re */
                                            -0.94154406518302081 /* im */
                                        },
                                        {
                                            1.2902846772544623,  /* re */
                                            -0.95694033573220882 /* im */
                                        },
                                        {
                                            1.2429801799032638, /* re */
                                            -0.970031253194544  /* im */
                                        },
                                        {
                                            1.1950903220161282,  /* re */
                                            -0.98078528040323043 /* im */
                                        },
                                        {
                                            1.1467304744553617, /* re */
                                            -0.989176509964781  /* im */
                                        },
                                        {
                                            1.0980171403295607,  /* re */
                                            -0.99518472667219693 /* im */
                                        },
                                        {
                                            1.0490676743274181,  /* re */
                                            -0.99879545620517241 /* im */
                                        }};
  static const double dv[32] = {1.0,
                                0.99518472667219693,
                                0.98078528040323043,
                                0.95694033573220882,
                                0.92387953251128674,
                                0.881921264348355,
                                0.83146961230254524,
                                0.773010453362737,
                                0.70710678118654757,
                                0.63439328416364549,
                                0.55557023301960218,
                                0.47139673682599764,
                                0.38268343236508978,
                                0.29028467725446233,
                                0.19509032201612825,
                                0.0980171403295606,
                                0.0,
                                -0.0980171403295606,
                                -0.19509032201612825,
                                -0.29028467725446233,
                                -0.38268343236508978,
                                -0.47139673682599764,
                                -0.55557023301960218,
                                -0.63439328416364549,
                                -0.70710678118654757,
                                -0.773010453362737,
                                -0.83146961230254524,
                                -0.881921264348355,
                                -0.92387953251128674,
                                -0.95694033573220882,
                                -0.98078528040323043,
                                -0.99518472667219693};
  static const double dv1[32] = {0.0,
                                 -0.0980171403295606,
                                 -0.19509032201612825,
                                 -0.29028467725446233,
                                 -0.38268343236508978,
                                 -0.47139673682599764,
                                 -0.55557023301960218,
                                 -0.63439328416364549,
                                 -0.70710678118654757,
                                 -0.773010453362737,
                                 -0.83146961230254524,
                                 -0.881921264348355,
                                 -0.92387953251128674,
                                 -0.95694033573220882,
                                 -0.98078528040323043,
                                 -0.99518472667219693,
                                 -1.0,
                                 -0.99518472667219693,
                                 -0.98078528040323043,
                                 -0.95694033573220882,
                                 -0.92387953251128674,
                                 -0.881921264348355,
                                 -0.83146961230254524,
                                 -0.773010453362737,
                                 -0.70710678118654757,
                                 -0.63439328416364549,
                                 -0.55557023301960218,
                                 -0.47139673682599764,
                                 -0.38268343236508978,
                                 -0.29028467725446233,
                                 -0.19509032201612825,
                                 -0.0980171403295606};
  static const signed char bitrevIndex[64] = {
      1, 33, 17, 49, 9,  41, 25, 57, 5, 37, 21, 53, 13, 45, 29, 61,
      3, 35, 19, 51, 11, 43, 27, 59, 7, 39, 23, 55, 15, 47, 31, 63,
      2, 34, 18, 50, 10, 42, 26, 58, 6, 38, 22, 54, 14, 46, 30, 62,
      4, 36, 20, 52, 12, 44, 28, 60, 8, 40, 24, 56, 16, 48, 32, 64};
  static const signed char iv[64] = {
      1,  64, 63, 62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50,
      49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34,
      33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18,
      17, 16, 15, 14, 13, 12, 11, 10, 9,  8,  7,  6,  5,  4,  3,  2};
  double b_im;
  double b_re;
  double im;
  double re;
  double temp2_im;
  double temp2_re;
  double temp_im;
  double temp_re;
  int b_i;
  int i;
  int iDelta;
  int iDelta2;
  int iheight;
  int istart;
  int j;
  int k;
  for (i = 0; i < 64; i++) {
    j = xoffInit + (i << 1);
    istart = bitrevIndex[i] - 1;
    y[istart].re = x[j];
    y[istart].im = x[j + 1];
  }
  for (i = 0; i <= 62; i += 2) {
    re = y[i + 1].re;
    im = y[i + 1].im;
    temp_re = re;
    temp_im = im;
    b_re = y[i].re;
    b_im = y[i].im;
    re = b_re - re;
    im = b_im - im;
    y[i + 1].re = re;
    y[i + 1].im = im;
    b_re += temp_re;
    b_im += temp_im;
    y[i].re = b_re;
    y[i].im = b_im;
  }
  iDelta = 2;
  iDelta2 = 4;
  k = 16;
  iheight = 61;
  while (k > 0) {
    for (b_i = 0; b_i < iheight; b_i += iDelta2) {
      j = b_i + iDelta;
      temp_re = y[j].re;
      temp_im = y[j].im;
      y[j].re = y[b_i].re - temp_re;
      y[j].im = y[b_i].im - temp_im;
      y[b_i].re += temp_re;
      y[b_i].im += temp_im;
    }
    istart = 1;
    for (j = k; j < 32; j += k) {
      int ihi;
      temp2_re = dv[j];
      temp2_im = dv1[j];
      b_i = istart;
      ihi = istart + iheight;
      while (b_i < ihi) {
        int temp_re_tmp;
        temp_re_tmp = b_i + iDelta;
        re = y[temp_re_tmp].im;
        im = y[temp_re_tmp].re;
        temp_re = temp2_re * im - temp2_im * re;
        temp_im = temp2_re * re + temp2_im * im;
        y[temp_re_tmp].re = y[b_i].re - temp_re;
        y[temp_re_tmp].im = y[b_i].im - temp_im;
        y[b_i].re += temp_re;
        y[b_i].im += temp_im;
        b_i += iDelta2;
      }
      istart++;
    }
    k >>= 1;
    iDelta = iDelta2;
    iDelta2 += iDelta2;
    iheight -= iDelta;
  }
  temp_re = y[0].re;
  temp_im = y[0].im;
  re = y[0].re - (-y[0].im);
  im = -y[0].re + y[0].im;
  b_re = -y[0].im;
  y[0].re = 0.5 * (re + re);
  y[0].im = 0.5 * (im + (temp_re + b_re));
  y[64].re = 0.5 * ((temp_re - temp_im) + (temp_re - (-b_re)));
  y[64].im = 0.5 * ((temp_re + temp_im) + (-temp_re + b_re));
  for (i = 0; i < 31; i++) {
    temp_re = y[i + 1].re;
    temp_im = y[i + 1].im;
    j = iv[i + 1];
    temp2_re = y[j - 1].re;
    temp2_im = y[j - 1].im;
    re = reconVar1[i + 1].im;
    im = reconVar1[i + 1].re;
    b_re = reconVar2[i + 1].im;
    b_im = reconVar2[i + 1].re;
    y[i + 1].re = 0.5 * ((temp_re * im - temp_im * re) +
                         (temp2_re * b_im - -temp2_im * b_re));
    y[i + 1].im = 0.5 * ((temp_re * re + temp_im * im) +
                         (temp2_re * b_re + -temp2_im * b_im));
    y[i + 65].re = 0.5 * ((temp_re * b_im - temp_im * b_re) +
                          (temp2_re * im - -temp2_im * re));
    y[i + 65].im = 0.5 * ((temp_re * b_re + temp_im * b_im) +
                          (temp2_re * re + -temp2_im * im));
    re = reconVar1[j - 1].im;
    im = reconVar1[j - 1].re;
    b_re = reconVar2[j - 1].im;
    b_im = reconVar2[j - 1].re;
    y[j - 1].re = 0.5 * ((temp2_re * im - temp2_im * re) +
                         (temp_re * b_im - -temp_im * b_re));
    y[j - 1].im = 0.5 * ((temp2_re * re + temp2_im * im) +
                         (temp_re * b_re + -temp_im * b_im));
    y[j + 63].re = 0.5 * ((temp2_re * b_im - temp2_im * b_re) +
                          (temp_re * im - -temp_im * re));
    y[j + 63].im = 0.5 * ((temp2_re * b_re + temp2_im * b_im) +
                          (temp_re * re + -temp_im * im));
  }
  temp_im = y[32].im;
  re = y[32].re * 0.0;
  im = y[32].im * 0.0;
  b_re = -y[32].im;
  b_im = y[32].re * 2.0;
  temp2_re = b_re * 0.0;
  y[32].re = 0.5 * ((re - im) + (b_im - temp2_re));
  y[32].im = 0.5 * ((re + im) + (re + b_re * 2.0));
  y[96].re = 0.5 * ((b_im - im) + (re - temp2_re));
  y[96].im = 0.5 * ((re + temp_im * 2.0) + (re + temp2_re));
}

static void f_FFTImplementationCallback_r2b(const emxArray_creal_T *x,
                                            int unsigned_nRows,
                                            const emxArray_real_T *costab,
                                            const emxArray_real_T *sintab,
                                            emxArray_creal_T *y)
{
  const creal_T *x_data;
  creal_T *y_data;
  const double *costab_data;
  const double *sintab_data;
  double im;
  double re;
  double temp_im;
  double temp_re;
  int b_i;
  int i;
  int iDelta;
  int iDelta2;
  int iheight;
  int istart;
  int iy;
  int j;
  int ju;
  int k;
  int nRowsD2;
  sintab_data = sintab->data;
  costab_data = costab->data;
  x_data = x->data;
  istart = y->size[0];
  y->size[0] = unsigned_nRows;
  emxEnsureCapacity_creal_T(y, istart);
  y_data = y->data;
  if (unsigned_nRows > x->size[0]) {
    istart = y->size[0];
    y->size[0] = unsigned_nRows;
    emxEnsureCapacity_creal_T(y, istart);
    y_data = y->data;
    for (i = 0; i < unsigned_nRows; i++) {
      y_data[i].re = 0.0;
      y_data[i].im = 0.0;
    }
  }
  j = x->size[0];
  if (j > unsigned_nRows) {
    j = unsigned_nRows;
  }
  iDelta = unsigned_nRows - 2;
  nRowsD2 = (int)((unsigned int)unsigned_nRows >> 1);
  k = (int)((unsigned int)nRowsD2 >> 1);
  iy = 0;
  ju = 0;
  for (i = 0; i <= j - 2; i++) {
    boolean_T tst;
    y_data[iy] = x_data[i];
    istart = unsigned_nRows;
    tst = true;
    while (tst) {
      istart >>= 1;
      ju ^= istart;
      tst = ((ju & istart) == 0);
    }
    iy = ju;
  }
  if (j - 2 < 0) {
    istart = 0;
  } else {
    istart = j - 1;
  }
  y_data[iy] = x_data[istart];
  if (unsigned_nRows > 1) {
    for (i = 0; i <= iDelta; i += 2) {
      temp_re = y_data[i + 1].re;
      temp_im = y_data[i + 1].im;
      re = y_data[i].re;
      im = y_data[i].im;
      y_data[i + 1].re = re - temp_re;
      y_data[i + 1].im = y_data[i].im - y_data[i + 1].im;
      re += temp_re;
      im += temp_im;
      y_data[i].re = re;
      y_data[i].im = im;
    }
  }
  iDelta = 2;
  iDelta2 = 4;
  iheight = ((k - 1) << 2) + 1;
  while (k > 0) {
    for (b_i = 0; b_i < iheight; b_i += iDelta2) {
      istart = b_i + iDelta;
      temp_re = y_data[istart].re;
      temp_im = y_data[istart].im;
      y_data[istart].re = y_data[b_i].re - temp_re;
      y_data[istart].im = y_data[b_i].im - temp_im;
      y_data[b_i].re += temp_re;
      y_data[b_i].im += temp_im;
    }
    istart = 1;
    for (j = k; j < nRowsD2; j += k) {
      double twid_im;
      double twid_re;
      twid_re = costab_data[j];
      twid_im = sintab_data[j];
      b_i = istart;
      iy = istart + iheight;
      while (b_i < iy) {
        ju = b_i + iDelta;
        re = y_data[ju].im;
        im = y_data[ju].re;
        temp_re = twid_re * im - twid_im * re;
        temp_im = twid_re * re + twid_im * im;
        y_data[ju].re = y_data[b_i].re - temp_re;
        y_data[ju].im = y_data[b_i].im - temp_im;
        y_data[b_i].re += temp_re;
        y_data[b_i].im += temp_im;
        b_i += iDelta2;
      }
      istart++;
    }
    k = (int)((unsigned int)k >> 1);
    iDelta = iDelta2;
    iDelta2 += iDelta2;
    iheight -= iDelta;
  }
}

void c_FFTImplementationCallback_dob(const emxArray_creal_T *x, int n2blue,
                                     int nfft, const emxArray_real_T *costab,
                                     const emxArray_real_T *sintab,
                                     const emxArray_real_T *sintabinv,
                                     emxArray_creal_T *y)
{
  emxArray_creal_T *fv;
  emxArray_creal_T *fy;
  emxArray_creal_T *r1;
  emxArray_creal_T *wwc;
  const creal_T *x_data;
  creal_T *fv_data;
  creal_T *fy_data;
  creal_T *r;
  creal_T *wwc_data;
  creal_T *y_data;
  const double *costab_data;
  const double *sintab_data;
  double im;
  double nt_im;
  double nt_re;
  double re;
  double temp_im;
  double temp_re;
  double twid_im;
  double twid_re;
  int b_k;
  int b_y;
  int c_k;
  int chan;
  int i;
  int iDelta;
  int iDelta2;
  int iheight;
  int istart;
  int k;
  int minNrowsNx;
  int nInt2;
  int nInt2m1;
  int nRowsD2;
  int rt;
  int u1;
  int xoff;
  boolean_T tst;
  sintab_data = sintab->data;
  costab_data = costab->data;
  x_data = x->data;
  nInt2m1 = (nfft + nfft) - 1;
  emxInit_creal_T(&wwc, 1);
  b_y = wwc->size[0];
  wwc->size[0] = nInt2m1;
  emxEnsureCapacity_creal_T(wwc, b_y);
  wwc_data = wwc->data;
  rt = 0;
  wwc_data[nfft - 1].re = 1.0;
  wwc_data[nfft - 1].im = 0.0;
  nInt2 = nfft << 1;
  for (k = 0; k <= nfft - 2; k++) {
    b_y = ((k + 1) << 1) - 1;
    if (nInt2 - rt <= b_y) {
      rt += b_y - nInt2;
    } else {
      rt += b_y;
    }
    nt_im = 3.1415926535897931 * (double)rt / (double)nfft;
    nt_re = cos(nt_im);
    nt_im = sin(nt_im);
    b_y = (nfft - k) - 2;
    wwc_data[b_y].re = nt_re;
    wwc_data[b_y].im = -nt_im;
  }
  b_y = nInt2m1 - 1;
  for (k = b_y; k >= nfft; k--) {
    wwc_data[k] = wwc_data[(nInt2m1 - k) - 1];
  }
  rt = x->size[0];
  b_y = y->size[0] * y->size[1];
  y->size[0] = nfft;
  y->size[1] = x->size[1];
  emxEnsureCapacity_creal_T(y, b_y);
  y_data = y->data;
  if (nfft > x->size[0]) {
    b_y = y->size[0] * y->size[1];
    y->size[0] = nfft;
    y->size[1] = x->size[1];
    emxEnsureCapacity_creal_T(y, b_y);
    y_data = y->data;
    b_y = nfft * x->size[1];
    for (k = 0; k < b_y; k++) {
      y_data[k].re = 0.0;
      y_data[k].im = 0.0;
    }
  }
  b_y = x->size[1];
#pragma omp parallel num_threads(omp_get_max_threads()) private(               \
        r, fy_data, fv_data, fv, fy, r1, xoff, istart, b_k, minNrowsNx,        \
            temp_re, temp_im, re, im, u1, iDelta, nRowsD2, c_k, tst, iDelta2,  \
            iheight, i, twid_re, twid_im)
  {
    emxInit_creal_T(&fv, 1);
    emxInit_creal_T(&fy, 1);
    emxInit_creal_T(&r1, 1);
#pragma omp for nowait
    for (chan = 0; chan < b_y; chan++) {
      xoff = chan * rt;
      istart = r1->size[0];
      r1->size[0] = nfft;
      emxEnsureCapacity_creal_T(r1, istart);
      r = r1->data;
      if (nfft > x->size[0]) {
        istart = r1->size[0];
        r1->size[0] = nfft;
        emxEnsureCapacity_creal_T(r1, istart);
        r = r1->data;
        for (b_k = 0; b_k < nfft; b_k++) {
          r[b_k].re = 0.0;
          r[b_k].im = 0.0;
        }
      }
      minNrowsNx = x->size[0];
      if (nfft <= minNrowsNx) {
        minNrowsNx = nfft;
      }
      for (b_k = 0; b_k < minNrowsNx; b_k++) {
        istart = (nfft + b_k) - 1;
        temp_re = wwc_data[istart].re;
        temp_im = wwc_data[istart].im;
        istart = xoff + b_k;
        re = x_data[istart].im;
        im = x_data[istart].re;
        r[b_k].re = temp_re * im + temp_im * re;
        r[b_k].im = temp_re * re - temp_im * im;
      }
      istart = minNrowsNx + 1;
      for (b_k = istart; b_k <= nfft; b_k++) {
        r[b_k - 1].re = 0.0;
        r[b_k - 1].im = 0.0;
      }
      istart = fy->size[0];
      fy->size[0] = n2blue;
      emxEnsureCapacity_creal_T(fy, istart);
      fy_data = fy->data;
      if (n2blue > r1->size[0]) {
        istart = fy->size[0];
        fy->size[0] = n2blue;
        emxEnsureCapacity_creal_T(fy, istart);
        fy_data = fy->data;
        for (b_k = 0; b_k < n2blue; b_k++) {
          fy_data[b_k].re = 0.0;
          fy_data[b_k].im = 0.0;
        }
      }
      istart = r1->size[0];
      u1 = n2blue;
      if (istart <= n2blue) {
        u1 = istart;
      }
      iDelta = n2blue - 2;
      nRowsD2 = (int)((unsigned int)n2blue >> 1);
      c_k = (int)((unsigned int)nRowsD2 >> 1);
      minNrowsNx = 0;
      xoff = 0;
      for (b_k = 0; b_k <= u1 - 2; b_k++) {
        fy_data[minNrowsNx] = r[b_k];
        istart = n2blue;
        tst = true;
        while (tst) {
          istart >>= 1;
          xoff ^= istart;
          tst = ((xoff & istart) == 0);
        }
        minNrowsNx = xoff;
      }
      if (u1 - 2 < 0) {
        istart = 0;
      } else {
        istart = u1 - 1;
      }
      fy_data[minNrowsNx] = r[istart];
      if (n2blue > 1) {
        for (b_k = 0; b_k <= iDelta; b_k += 2) {
          temp_re = fy_data[b_k + 1].re;
          temp_im = fy_data[b_k + 1].im;
          re = fy_data[b_k].re;
          im = fy_data[b_k].im;
          fy_data[b_k + 1].re = re - temp_re;
          fy_data[b_k + 1].im = fy_data[b_k].im - fy_data[b_k + 1].im;
          re += temp_re;
          im += temp_im;
          fy_data[b_k].re = re;
          fy_data[b_k].im = im;
        }
      }
      iDelta = 2;
      iDelta2 = 4;
      iheight = ((c_k - 1) << 2) + 1;
      while (c_k > 0) {
        for (i = 0; i < iheight; i += iDelta2) {
          istart = i + iDelta;
          temp_re = fy_data[istart].re;
          temp_im = fy_data[istart].im;
          fy_data[istart].re = fy_data[i].re - temp_re;
          fy_data[istart].im = fy_data[i].im - temp_im;
          fy_data[i].re += temp_re;
          fy_data[i].im += temp_im;
        }
        istart = 1;
        for (minNrowsNx = c_k; minNrowsNx < nRowsD2; minNrowsNx += c_k) {
          twid_re = costab_data[minNrowsNx];
          twid_im = sintab_data[minNrowsNx];
          i = istart;
          xoff = istart + iheight;
          while (i < xoff) {
            u1 = i + iDelta;
            re = fy_data[u1].im;
            im = fy_data[u1].re;
            temp_re = twid_re * im - twid_im * re;
            temp_im = twid_re * re + twid_im * im;
            fy_data[u1].re = fy_data[i].re - temp_re;
            fy_data[u1].im = fy_data[i].im - temp_im;
            fy_data[i].re += temp_re;
            fy_data[i].im += temp_im;
            i += iDelta2;
          }
          istart++;
        }
        c_k = (int)((unsigned int)c_k >> 1);
        iDelta = iDelta2;
        iDelta2 += iDelta2;
        iheight -= iDelta;
      }
      f_FFTImplementationCallback_r2b(wwc, n2blue, costab, sintab, fv);
      fv_data = fv->data;
      istart = fy->size[0];
      for (b_k = 0; b_k < istart; b_k++) {
        re = fy_data[b_k].re;
        im = fv_data[b_k].im;
        twid_re = fy_data[b_k].im;
        twid_im = fv_data[b_k].re;
        fy_data[b_k].re = re * twid_im - twid_re * im;
        fy_data[b_k].im = re * im + twid_re * twid_im;
      }
      f_FFTImplementationCallback_r2b(fy, n2blue, costab, sintabinv, fv);
      fv_data = fv->data;
      if (fv->size[0] > 1) {
        re = 1.0 / (double)fv->size[0];
        istart = fv->size[0];
        for (b_k = 0; b_k < istart; b_k++) {
          fv_data[b_k].re *= re;
          fv_data[b_k].im *= re;
        }
      }
      minNrowsNx = wwc->size[0];
      for (b_k = nfft; b_k <= minNrowsNx; b_k++) {
        re = wwc_data[b_k - 1].re;
        im = fv_data[b_k - 1].im;
        twid_re = wwc_data[b_k - 1].im;
        twid_im = fv_data[b_k - 1].re;
        temp_im = re * twid_im + twid_re * im;
        re = re * im - twid_re * twid_im;
        if (re == 0.0) {
          istart = b_k - nfft;
          r[istart].re = temp_im / (double)nfft;
          r[istart].im = 0.0;
        } else if (temp_im == 0.0) {
          istart = b_k - nfft;
          r[istart].re = 0.0;
          r[istart].im = re / (double)nfft;
        } else {
          istart = b_k - nfft;
          r[istart].re = temp_im / (double)nfft;
          r[istart].im = re / (double)nfft;
        }
      }
      istart = y->size[0];
      for (b_k = 0; b_k < istart; b_k++) {
        y_data[b_k + y->size[0] * chan] = r[b_k];
      }
    }
    emxFree_creal_T(&r1);
    emxFree_creal_T(&fy);
    emxFree_creal_T(&fv);
  }
  emxFree_creal_T(&wwc);
}

void c_FFTImplementationCallback_gen(int nRows, boolean_T useRadix2,
                                     emxArray_real_T *costab,
                                     emxArray_real_T *sintab,
                                     emxArray_real_T *sintabinv)
{
  emxArray_real_T *costab1q;
  double e;
  double *costab1q_data;
  double *costab_data;
  double *sintab_data;
  double *sintabinv_data;
  int b_k;
  int b_n;
  int c_k;
  int d_k;
  int e_k;
  int f_k;
  int g_k;
  int h_k;
  int k;
  int n;
  int nd2;
  e = 6.2831853071795862 / (double)nRows;
  n = (int)(((unsigned int)nRows >> 1) >> 1);
  emxInit_real_T(&costab1q, 2);
  nd2 = costab1q->size[0] * costab1q->size[1];
  costab1q->size[0] = 1;
  costab1q->size[1] = n + 1;
  emxEnsureCapacity_real_T(costab1q, nd2);
  costab1q_data = costab1q->data;
  costab1q_data[0] = 1.0;
  nd2 = (int)((unsigned int)n >> 1) - 1;
  if (nd2 + 1 < 1600) {
    for (k = 0; k <= nd2; k++) {
      costab1q_data[k + 1] = cos(e * ((double)k + 1.0));
    }
  } else {
#pragma omp parallel for num_threads(omp_get_max_threads())

    for (k = 0; k <= nd2; k++) {
      costab1q_data[k + 1] = cos(e * ((double)k + 1.0));
    }
  }
  b_n = nd2 + 2;
  if ((n - nd2) - 2 < 1600) {
    for (b_k = b_n; b_k < n; b_k++) {
      costab1q_data[b_k] = sin(e * (double)(n - b_k));
    }
  } else {
#pragma omp parallel for num_threads(omp_get_max_threads())

    for (b_k = b_n; b_k < n; b_k++) {
      costab1q_data[b_k] = sin(e * (double)(n - b_k));
    }
  }
  costab1q_data[n] = 0.0;
  if (!useRadix2) {
    int n2;
    n = costab1q->size[1] - 1;
    n2 = (costab1q->size[1] - 1) << 1;
    nd2 = costab->size[0] * costab->size[1];
    costab->size[0] = 1;
    costab->size[1] = n2 + 1;
    emxEnsureCapacity_real_T(costab, nd2);
    costab_data = costab->data;
    nd2 = sintab->size[0] * sintab->size[1];
    sintab->size[0] = 1;
    sintab->size[1] = n2 + 1;
    emxEnsureCapacity_real_T(sintab, nd2);
    sintab_data = sintab->data;
    costab_data[0] = 1.0;
    sintab_data[0] = 0.0;
    nd2 = sintabinv->size[0] * sintabinv->size[1];
    sintabinv->size[0] = 1;
    sintabinv->size[1] = n2 + 1;
    emxEnsureCapacity_real_T(sintabinv, nd2);
    sintabinv_data = sintabinv->data;
    nd2 = (costab1q->size[1] - 1 < 1600);
    if (nd2) {
      for (e_k = 0; e_k < n; e_k++) {
        sintabinv_data[e_k + 1] = costab1q_data[(n - e_k) - 1];
      }
    } else {
#pragma omp parallel for num_threads(omp_get_max_threads())

      for (e_k = 0; e_k < n; e_k++) {
        sintabinv_data[e_k + 1] = costab1q_data[(n - e_k) - 1];
      }
    }
    b_n = costab1q->size[1];
    for (f_k = b_n; f_k <= n2; f_k++) {
      sintabinv_data[f_k] = costab1q_data[f_k - n];
    }
    if (nd2) {
      for (g_k = 0; g_k < n; g_k++) {
        costab_data[g_k + 1] = costab1q_data[g_k + 1];
        sintab_data[g_k + 1] = -costab1q_data[(n - g_k) - 1];
      }
    } else {
#pragma omp parallel for num_threads(omp_get_max_threads())

      for (g_k = 0; g_k < n; g_k++) {
        costab_data[g_k + 1] = costab1q_data[g_k + 1];
        sintab_data[g_k + 1] = -costab1q_data[(n - g_k) - 1];
      }
    }
    if ((n2 - costab1q->size[1]) + 1 < 1600) {
      for (h_k = b_n; h_k <= n2; h_k++) {
        costab_data[h_k] = -costab1q_data[n2 - h_k];
        sintab_data[h_k] = -costab1q_data[h_k - n];
      }
    } else {
#pragma omp parallel for num_threads(omp_get_max_threads())

      for (h_k = b_n; h_k <= n2; h_k++) {
        costab_data[h_k] = -costab1q_data[n2 - h_k];
        sintab_data[h_k] = -costab1q_data[h_k - n];
      }
    }
  } else {
    b_n = costab1q->size[1] - 1;
    n = (costab1q->size[1] - 1) << 1;
    nd2 = costab->size[0] * costab->size[1];
    costab->size[0] = 1;
    costab->size[1] = n + 1;
    emxEnsureCapacity_real_T(costab, nd2);
    costab_data = costab->data;
    nd2 = sintab->size[0] * sintab->size[1];
    sintab->size[0] = 1;
    sintab->size[1] = n + 1;
    emxEnsureCapacity_real_T(sintab, nd2);
    sintab_data = sintab->data;
    costab_data[0] = 1.0;
    sintab_data[0] = 0.0;
    if (costab1q->size[1] - 1 < 1600) {
      for (c_k = 0; c_k < b_n; c_k++) {
        costab_data[c_k + 1] = costab1q_data[c_k + 1];
        sintab_data[c_k + 1] = costab1q_data[(b_n - c_k) - 1];
      }
    } else {
#pragma omp parallel for num_threads(omp_get_max_threads())

      for (c_k = 0; c_k < b_n; c_k++) {
        costab_data[c_k + 1] = costab1q_data[c_k + 1];
        sintab_data[c_k + 1] = costab1q_data[(b_n - c_k) - 1];
      }
    }
    nd2 = costab1q->size[1];
    if ((n - costab1q->size[1]) + 1 < 1600) {
      for (d_k = nd2; d_k <= n; d_k++) {
        costab_data[d_k] = -costab1q_data[n - d_k];
        sintab_data[d_k] = costab1q_data[d_k - b_n];
      }
    } else {
#pragma omp parallel for num_threads(omp_get_max_threads())

      for (d_k = nd2; d_k <= n; d_k++) {
        costab_data[d_k] = -costab1q_data[n - d_k];
        sintab_data[d_k] = costab1q_data[d_k - b_n];
      }
    }
    sintabinv->size[0] = 1;
    sintabinv->size[1] = 0;
  }
  emxFree_real_T(&costab1q);
}

int c_FFTImplementationCallback_get(int nfft, boolean_T useRadix2, int *nRows)
{
  int n2blue;
  n2blue = 1;
  if (useRadix2) {
    *nRows = nfft;
  } else {
    if (nfft > 0) {
      int pmax;
      n2blue = (nfft + nfft) - 1;
      pmax = 31;
      if (n2blue <= 1) {
        pmax = 0;
      } else {
        int pmin;
        boolean_T exitg1;
        pmin = 0;
        exitg1 = false;
        while ((!exitg1) && (pmax - pmin > 1)) {
          int k;
          int pow2p;
          k = (pmin + pmax) >> 1;
          pow2p = 1 << k;
          if (pow2p == n2blue) {
            pmax = k;
            exitg1 = true;
          } else if (pow2p > n2blue) {
            pmax = k;
          } else {
            pmin = k;
          }
        }
      }
      n2blue = 1 << pmax;
    }
    *nRows = n2blue;
  }
  return n2blue;
}

void c_FFTImplementationCallback_r2b(const double x[16384], creal_T y[16384])
{
  int chan;
  int xoff;
#pragma omp parallel for num_threads(omp_get_max_threads()) private(xoff)

  for (chan = 0; chan < 128; chan++) {
    xoff = chan << 7;
    c_FFTImplementationCallback_doH(x, xoff, &y[xoff]);
  }
}

void d_FFTImplementationCallback_r2b(const creal_T x[16384],
                                     const double costab[65],
                                     const double sintab[65], creal_T y[16384])
{
  double im;
  double re;
  double temp_im;
  double temp_re;
  double twid_im;
  double twid_re;
  int b_i;
  int c_i;
  int chan;
  int i;
  int iDelta;
  int iDelta2;
  int iheight;
  int ihi;
  int iy;
  int ju;
  int k;
  int temp_re_tmp;
  int xoff;
  boolean_T tst;
#pragma omp parallel for num_threads(omp_get_max_threads()) private(           \
        xoff, iy, ju, i, tst, iDelta, re, im, temp_re, temp_im, twid_re,       \
            twid_im, iDelta2, k, iheight, b_i, ihi, temp_re_tmp, c_i)

  for (chan = 0; chan < 128; chan++) {
    xoff = chan << 7;
    iy = 0;
    ju = 0;
    for (i = 0; i < 127; i++) {
      y[iy + xoff] = x[xoff + i];
      iy = 128;
      tst = true;
      while (tst) {
        iy >>= 1;
        ju ^= iy;
        tst = ((ju & iy) == 0);
      }
      iy = ju;
    }
    y[iy + xoff] = x[xoff + 127];
    for (i = 0; i <= 126; i += 2) {
      iy = i + xoff;
      re = y[iy + 1].re;
      im = y[iy + 1].im;
      temp_re = re;
      temp_im = im;
      twid_re = y[iy].re;
      twid_im = y[iy].im;
      re = twid_re - re;
      im = twid_im - im;
      y[iy + 1].re = re;
      y[iy + 1].im = im;
      twid_re += temp_re;
      twid_im += temp_im;
      y[iy].re = twid_re;
      y[iy].im = twid_im;
    }
    iDelta = 2;
    iDelta2 = 4;
    k = 32;
    iheight = 125;
    while (k > 0) {
      for (b_i = 0; b_i < iheight; b_i += iDelta2) {
        iy = (b_i + iDelta) + xoff;
        temp_re = y[iy].re;
        temp_im = y[iy].im;
        ju = b_i + xoff;
        y[iy].re = y[ju].re - temp_re;
        y[iy].im = y[ju].im - temp_im;
        y[ju].re += temp_re;
        y[ju].im += temp_im;
      }
      iy = 1;
      for (ju = k; ju < 64; ju += k) {
        twid_re = costab[ju];
        twid_im = sintab[ju];
        b_i = iy;
        ihi = iy + iheight;
        while (b_i < ihi) {
          temp_re_tmp = (b_i + iDelta) + xoff;
          re = y[temp_re_tmp].im;
          im = y[temp_re_tmp].re;
          temp_re = twid_re * im - twid_im * re;
          temp_im = twid_re * re + twid_im * im;
          c_i = b_i + xoff;
          y[temp_re_tmp].re = y[c_i].re - temp_re;
          y[temp_re_tmp].im = y[c_i].im - temp_im;
          y[c_i].re += temp_re;
          y[c_i].im += temp_im;
          b_i += iDelta2;
        }
        iy++;
      }
      k >>= 1;
      iDelta = iDelta2;
      iDelta2 += iDelta2;
      iheight -= iDelta;
    }
  }
}

void e_FFTImplementationCallback_r2b(const emxArray_creal_T *x, int n1_unsigned,
                                     const emxArray_real_T *costab,
                                     const emxArray_real_T *sintab,
                                     emxArray_creal_T *y)
{
  emxArray_creal_T *r1;
  const creal_T *x_data;
  creal_T *r;
  creal_T *y_data;
  const double *costab_data;
  const double *sintab_data;
  double b;
  double im;
  double re;
  double temp_im;
  double temp_re;
  double twid_im;
  double twid_re;
  int b_i;
  int c_i;
  int chan;
  int i;
  int i1;
  int iDelta2;
  int iheight;
  int ihi;
  int iy;
  int ju;
  int k;
  int loop_ub;
  int nRowsD2;
  int nRowsM2;
  int nrows;
  int xoff;
  boolean_T tst;
  sintab_data = sintab->data;
  costab_data = costab->data;
  x_data = x->data;
  nrows = x->size[0];
  loop_ub = y->size[0] * y->size[1];
  y->size[0] = n1_unsigned;
  y->size[1] = x->size[1];
  emxEnsureCapacity_creal_T(y, loop_ub);
  y_data = y->data;
  if (n1_unsigned > x->size[0]) {
    loop_ub = y->size[0] * y->size[1];
    y->size[0] = n1_unsigned;
    y->size[1] = x->size[1];
    emxEnsureCapacity_creal_T(y, loop_ub);
    y_data = y->data;
    loop_ub = n1_unsigned * x->size[1];
    for (i = 0; i < loop_ub; i++) {
      y_data[i].re = 0.0;
      y_data[i].im = 0.0;
    }
  }
  loop_ub = x->size[1];
#pragma omp parallel num_threads(omp_get_max_threads()) private(               \
        r, r1, xoff, iy, b_i, ihi, nRowsM2, nRowsD2, k, ju, tst, temp_re,      \
            temp_im, re, im, iDelta2, iheight, c_i, twid_re, twid_im)
  {
    emxInit_creal_T(&r1, 1);
#pragma omp for nowait
    for (chan = 0; chan < loop_ub; chan++) {
      xoff = chan * nrows;
      iy = r1->size[0];
      r1->size[0] = n1_unsigned;
      emxEnsureCapacity_creal_T(r1, iy);
      r = r1->data;
      if (n1_unsigned > x->size[0]) {
        iy = r1->size[0];
        r1->size[0] = n1_unsigned;
        emxEnsureCapacity_creal_T(r1, iy);
        r = r1->data;
        for (b_i = 0; b_i < n1_unsigned; b_i++) {
          r[b_i].re = 0.0;
          r[b_i].im = 0.0;
        }
      }
      iy = x->size[0];
      ihi = n1_unsigned;
      if (iy <= n1_unsigned) {
        ihi = iy;
      }
      nRowsM2 = n1_unsigned - 2;
      nRowsD2 = (int)((unsigned int)n1_unsigned >> 1);
      k = (int)((unsigned int)nRowsD2 >> 1);
      iy = 0;
      ju = 0;
      for (b_i = 0; b_i <= ihi - 2; b_i++) {
        r[iy] = x_data[xoff + b_i];
        iy = n1_unsigned;
        tst = true;
        while (tst) {
          iy >>= 1;
          ju ^= iy;
          tst = ((ju & iy) == 0);
        }
        iy = ju;
      }
      if (ihi - 2 >= 0) {
        xoff = (xoff + ihi) - 1;
      }
      r[iy] = x_data[xoff];
      if (n1_unsigned > 1) {
        for (b_i = 0; b_i <= nRowsM2; b_i += 2) {
          temp_re = r[b_i + 1].re;
          temp_im = r[b_i + 1].im;
          re = r[b_i].re;
          im = r[b_i].im;
          r[b_i + 1].re = re - temp_re;
          r[b_i + 1].im = r[b_i].im - r[b_i + 1].im;
          re += temp_re;
          im += temp_im;
          r[b_i].re = re;
          r[b_i].im = im;
        }
      }
      xoff = 2;
      iDelta2 = 4;
      iheight = ((k - 1) << 2) + 1;
      while (k > 0) {
        for (c_i = 0; c_i < iheight; c_i += iDelta2) {
          iy = c_i + xoff;
          temp_re = r[iy].re;
          temp_im = r[iy].im;
          r[iy].re = r[c_i].re - temp_re;
          r[iy].im = r[c_i].im - temp_im;
          r[c_i].re += temp_re;
          r[c_i].im += temp_im;
        }
        iy = 1;
        for (ju = k; ju < nRowsD2; ju += k) {
          twid_re = costab_data[ju];
          twid_im = sintab_data[ju];
          c_i = iy;
          ihi = iy + iheight;
          while (c_i < ihi) {
            nRowsM2 = c_i + xoff;
            re = r[nRowsM2].im;
            im = r[nRowsM2].re;
            temp_re = twid_re * im - twid_im * re;
            temp_im = twid_re * re + twid_im * im;
            r[nRowsM2].re = r[c_i].re - temp_re;
            r[nRowsM2].im = r[c_i].im - temp_im;
            r[c_i].re += temp_re;
            r[c_i].im += temp_im;
            c_i += iDelta2;
          }
          iy++;
        }
        k = (int)((unsigned int)k >> 1);
        xoff = iDelta2;
        iDelta2 += iDelta2;
        iheight -= xoff;
      }
      iy = y->size[0];
      for (b_i = 0; b_i < iy; b_i++) {
        y_data[b_i + y->size[0] * chan] = r[b_i];
      }
    }
    emxFree_creal_T(&r1);
  }
  if (y->size[0] > 1) {
    b = 1.0 / (double)y->size[0];
    loop_ub = y->size[0] * y->size[1];
    if (loop_ub < 1600) {
      for (i1 = 0; i1 < loop_ub; i1++) {
        y_data[i1].re *= b;
        y_data[i1].im *= b;
      }
    } else {
#pragma omp parallel for num_threads(omp_get_max_threads())

      for (i1 = 0; i1 < loop_ub; i1++) {
        y_data[i1].re *= b;
        y_data[i1].im *= b;
      }
    }
  }
}

/* End of code generation (FFTImplementationCallback.c) */
